# シフト管理Bot

このリポジトリは、Discordチャンネルを利用してシフト希望の募集と管理を簡単に行うためのシフト管理Botです。

## ファイル構造

shift/  
├── source/  
│ ├── shift_for_excel.py  
│ ├── name.txt  
│ ├── recruitment_status.txt  
│ ├── last_reset.txt  
│ ├── message_id.txt  
│ ├── shift_schedule.xlsx  
│ └── 曜日.jpeg  
├── shift_確認用.xlsx  
└── run_shift.bat  


- **shift_for_excel.py**: Botのメインプログラムです。基本的にいじらないでください。
- **name.txt**: 従業員のDiscordのIDとシフトに記載する名前を1行ずつ書くファイルです。
- **recruitment_status.txt**: 来週のシフトを募集前、募集中、締め切りのどれかを保持するファイルです。いじらないでください。
- **last_reset.txt**: 次週が始まったときに募集状況をリセットするためのファイルです。いじらないでください。
- **message_id.txt**: リアクションを付けるメッセージのIDを保持するファイルです。勝手に更新されますので、いじらないでください。
- **shift_schedule.xlsx**: シフト管理用のエクセルファイルです。システムが操作するので、絶対に開かないでください。
- **曜日.jpeg**: Discordのリアクションとして登録する画像ファイルです。
- **shift_確認用.xlsx**: 募集状況を確認するためのファイルです。Botが閉じているときに見るのが望ましいですが、どちらでも構いません。
- **run_shift.bat**: Botを起動するための実行ファイルです。

## 初期設定

1. Botを用意し、`TOKEN` に代入します。
2. 曜日の画像を登録し、`Sunday`, `Monday`, ... にそれぞれIDを代入します。
   - 例: `:Sunday:` のIDが1234567であれば、 `Sunday = "<:Sunday:1234567>"`
3. 「シフト管理者用のチャンネル」と「シフト配信チャンネル」を作成し、それぞれのチャンネルIDを `ID_CHANNEL_only_managers` と `ID_CHANNEL_SHIFT` に代入します。

## Botの起動

1. `run_shift.bat` ファイルをダブルクリックします。
2. プログラムが正常に起動すると、「シフト管理者用のチャンネル」に「Botが起動しました。現在の募集状況：○○○○」というメッセージが表示されます。

## シフト希望の募集

1. 「シフト管理者用のチャンネル」で「シフト」と入力します。
   - 例: 「シフト管理者用のチャンネル」に「シフト」とメッセージを送信します。
2. 現在の募集状況が「締め切り済み」の場合、再募集するかどうかを確認されます。「はい」または「いいえ」で答えてください。
   - 例: 「シフト希望は既に締め切られています。再募集しますか？『はい』または『いいえ』で答えてください。」
3. 新しいシフト希望の募集が開始されると、シフト希望を募集するメッセージが「シフト配信チャンネル」に投稿されます。

## シフト希望の締め切り

1. 「シフト管理者用のチャンネル」で「締め切り」と入力します。
   - 例: 「シフト管理者用のチャンネル」に「締め切り」とメッセージを送信します。
2. シフト希望の募集が締め切られ、「シフト配信チャンネル」に「シフト希望の募集を締め切りました。」というメッセージが投稿されます。

## シフト希望の確認

1. シフト希望の状況を確認するために `shift_確認用.xlsx` を開きます。
   - このファイルは、リアクションが追加または削除されるたびに最新の情報に更新されます。
   - **注意**: `source` フォルダ内の `shift_schedule.xlsx` は開かないでください。データの整合性が損なわれる可能性があります。

## よくある質問

### Q1: 次の週になったら特別な操作が必要ですか？

A1: 特別な操作は必要ありません。Botは自動的に次の週のシフト希望の募集状態をリセットします。ただし、新しい週のシフト希望を募集する場合は「シフト」と入力してください。

### Q2: 締め切り後にシフト希望を再募集するにはどうすればよいですか？

A2: 管理者専用チャンネルで「シフト」と入力し、再募集の確認に「はい」と答えると、再募集が開始されます。

### Q3: 何か問題が発生した場合はどうすればよいですか？

A3: このプログラムをセットアップした担当者に連絡してください。
